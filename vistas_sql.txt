AQUÍ SE PUBLICARÁ LAS CREACIONES DE VISTAS Y/O PROCEDIMIENTOS DE LA BASE DE DATOS

create view v_usuario as
select u.codi_usu,
u.codi_rol,
u.reg_usu,
r.nomb_rol,
u.nomb_usu,
u.pass_usu,
u.acce_usu,
u.ses_usu,
u.esta_usu
from usuario u, rol r
where u.codi_rol = r.codi_rol 
order by u.codi_usu asc;

CREATE VIEW v_producto AS
SELECT p.codi_prod,
p.codi_tpro,
tp.nomb_tipo,
p.nomb_prod,
p.prec_prod,
p.fein_prod,
p.fesa_prod,
p.stoc_prod,
p.obsv_prod,
p.esta_prod
FROM producto p, tipo_producto tp 
where p.codi_tpro = tp.codi_tpro
ORDER BY tp.nomb_tipo ASC;

CREATE VIEW v_producto_compra AS
SELECT p.codi_prod,
p.codi_tpro,
tp.nomb_tipo,
p.nomb_prod,
p.prec_prod,
p.fein_prod,
p.fesa_prod,
p.stoc_prod,
p.obsv_prod,
p.esta_prod
FROM producto p, tipo_producto tp 
where p.codi_tpro = tp.codi_tpro
and p.prec_prod > 0
and p.esta_prod = 'A'
ORDER BY tp.nomb_tipo ASC;

create view v_caja_dia as
select cd.codi_cad,
cd.codi_caj,
c.num_caj,
cd.fein_cad,
cd.usin_cad,
ui.nomb_usu AS usu_ini,
cd.sain_cad,
cd.fefi_cad,
cd.usfi_cad,
uf.nomb_usu AS usu_fin,
cd.safi_cad,
cd.obsv_cad,
cd.esta_cad
from caja c, caja_dia cd, usuario ui, usuario uf
where cd.codi_caj = c.codi_caj
and cd.usin_cad = ui.codi_usu
and cd.usfi_cad = uf.codi_usu
order by cd.fein_cad desc;

create view v_caja_chica_dia as
select cc.codi_ccd,
cc.codi_cac,
cc.fein_ccd,
cc.usin_ccd,
ui.nomb_usu AS usu_ini,
cc.sain_ccd,
cc.fefi_ccd,
cc.usfi_ccd,
uf.nomb_usu AS usu_fin,
cc.safi_ccd,
cc.dife_ccd,
cc.obsv_ccd,
cc.esta_ccd
from caja_chica_dia cc, usuario ui, usuario uf
where cc.usin_ccd = ui.codi_usu
and cc.usfi_ccd = uf.codi_usu
order by cc.fein_ccd desc;

create view v_concepto as
select c.codi_con,
c.fech_con,
c.codi_usu,
u.nomb_usu,
c.nomb_con,
c.esta_con
from concepto c, usuario u
where c.codi_usu = u.codi_usu
order by c.codi_con asc

create view v_registro_planilla as
select rp.codi_dpl,
rp.codi_usu,
rp.fech_dpl,
u.nomb_usu,
rp.codi_emp,
e.nomb_emp,
e.apel_emp,
rp.suel_pla,
rp.cant_dpl,
rp.suto_dpl,
rp.desc_dpl,
rp.tota_dpl,
rp.obsv_dpl,
rp.esta_dpl
from registro_planilla rp, usuario u, empleado e
where rp.codi_usu = u.codi_usu
and rp.codi_emp = e.codi_emp
order by rp.fech_dpl desc;

create view v_gastos as
select g.codi_gas,
g.fech_gas,
g.codi_cac,
g.codi_usu,
u.nomb_usu,
g.codi_con,
c.nomb_con,
g.nomb_gas,
g.impo_gas,
g.obsv_gas,
g.esta_gas
from gastos g, usuario u, concepto c
where g.codi_usu = u.codi_usu
and g.codi_con = c.codi_con
order by g.fech_gas desc;

CREATE VIEW v_registro
AS
SELECT u.nomb_usu, e.apel_emp, e.nomb_emp, r.fech_dpl, r.suel_pla, r.cant_dpl, r.suto_dpl, r.desc_dpl, r.tota_dpl, r.obsv_dpl, r.esta_dpl
FROM registro_planilla as r, usuario as u, empleado as e
WHERE r.codi_usu = u.codi_usu AND e.codi_emp = r.codi_emp;

CREATE VIEW v_factura
AS
SELECT f.codi_fac, f.desp_fac, c.apel_cli, c.nomb_cli, c.dire_cli, c.ruc_cli, f.fech_fac,
v.cantidad, p.nomb_prod, p.prec_prod ,v.impo_dve, e.tota_ven
FROM factura f, detalle_factura d, detalle_venta v, producto p, venta e, cliente c
WHERE f.codi_fac = d.codi_fac AND d.codi_dve = v.codi_dve AND v.codi_prod = p.codi_prod AND v.codi_ven = e.codi_ven AND c.codi_cli = e.codi_cli;
